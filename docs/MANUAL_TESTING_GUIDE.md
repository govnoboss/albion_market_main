# Ручное Тестирование Системы Подписки

Этот гайд проведет вас через весь процесс: от запуска сервера до активации бота. Вы будете выступать и в роли Админа, и в роли Клиента.

## Часть 1: Подготовка (Один раз)

Сначала убедимся, что все библиотеки установлены.
Откройте терминал (PowerShell / CMD) в папке проекта и выполните:

```powershell
pip install fastapi uvicorn sqlalchemy requests pydantic
```

---

## Часть 2: Роль АДМИНА (Сервер)

Ваша задача: Запустить "магазин" и создать ключ для продажи.

### 1. Запуск сервера
Если у вас уже запущен сервер (видите "Uvicorn running..."), пропустите этот шаг. Если нет:
1. Откройте **новый терминал**.
2. Введите:
   ```powershell
   python server/main.py
   ```
3. Не закрывайте это окно! Сервер должен работать, пока вы проверяете бота.

### 2. Генерация ключа
1. Откройте браузер (Chrome/Edge).
2. Перейдите по адресу: **http://127.0.0.1:8000/docs**
   *(Вы увидите панель управления API)*.
3. Прокрутите вниз до зеленой полоски **POST /api/v1/admin/generate**.
4. Нажмите кнопку **Try it out** (справа).
5. В поле `Request body` замените текст на:
   ```json
   {
     "admin_password": "secret_password",
     "days": 30,
     "count": 1
   }
   ```
6. Нажмите синюю кнопку **Execute**.
7. Внизу (в поле Response body) появится ответ. 
   **Скопируйте ключ** из списка `"keys": [ "ВАШ-КЛЮЧ-ЗДЕСЬ" ]`.

---

## Часть 3: Роль ПОЛЬЗОВАТЕЛЯ (Клиент)

Ваша задача: Скачать бота (условно), запустить и активировать.

### 1. Чистый старт
Чтобы тест был честным, убедитесь, что у вас нет старых сохраненных ключей.
1. Зайдите в папку вашего пользователя Windows (`C:\Users\Student\`).
2. Если найдете файл `.gbot_license`, **удалите его**.

### 2. Запуск Бота
1. Вернитесь в VS Code (или терминал).
2. Запустите файл лаунчера:
   ```powershell
   python src/main.py
   ```
   *(Или тот файл, через который вы обычно запускаете бота. Если такого нет, попробуйте `python -m src.ui.launcher` или создайте временный `run.py`)*.

   > **Примечание:** Если у вас нет `src/main.py`, запустите скрипт проверки напрямую:
   > ```python
   > # Создайте файл run_test.py
   > from PyQt6.QtWidgets import QApplication
   > from src.ui.launcher import LauncherWindow
   > import sys
   > 
   > app = QApplication(sys.argv)
   > win = LauncherWindow()
   > # win.show() # LauncherWindow сам покажет LoginWindow, если лицензии нет
   > sys.exit(app.exec())
   > ```

### 3. Активация
1. Должно появиться окно **GBot Activation**.
2. Вставьте скопированный Ключ.
3. Нажмите **ACTIVATE**.
4. Должна появиться зеленая надпись "Success! Loading...".
5. Окно активации закроется, и откроется **Launcher** (Главное меню).

---

## Часть 4: Проверка Повторного Входа
1. Закройте Лаунчер.
2. Запустите `run_test.py` снова.
3. Окно активации **НЕ должно** появляться. Лаунчер должен открыться сразу.
   *(Это значит, что ключ сохранился и прошел валидацию тихо).*

## Часть 5: Проверка Защиты (Опционально)
1. Остановите сервер (Ctrl+C в терминале сервера).
2. Попробуйте запустить бота.
3. Он должен выдать ошибку (так как не может проверить лицензию) или, если мы настроили кеширование жестко, пустить. 
   *(В текущей версии `license.py` требует онлайн проверки при каждом старте для надежности).*
